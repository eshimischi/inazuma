svg(:height="height", :width="width")
    defs
        mask(key="m:node", :id="nodeMaskId", maskUnits="userSpaceOnUse")
            rect(width="100%", height="100%", fill="white")
            circle(:cx="nodeX", :cy="nodeY", :r="radius + 1", fill="black")
        mask(key="m:line", :id="lineMaskId", maskUnits="userSpaceOnUse")
            rect(width="100%", height="100%", fill="white")
            circle(:cx="nodeX", :cy="nodeY", :r="radius + 1", fill="black")
            path(v-for="edge in foregroundEdges",
                 :key="nodeEdgeKey(edge)",
                 :d="nodeEdgePath(edge)",
                 stroke="black", :stroke-width="4", fill="none")

    line(v-for="edge in graph.interEdges",
         :key="interEdgeKey(edge)",
         :x1="c2x(edge.index)", y1="0",
         :x2="c2x(edge.index)", :y2="height",
         :stroke="edge.color", :stroke-width="2",
         :mask="maskUrl(lineMaskId)")

    template(v-for="(edge, i) in graph.nodeEdges")
        line(v-if="edge.index === nodeIdx",
             :key="nodeEdgeKey(edge)",
             :x1="c2x(edge.index)", :y1="edge.type === 'C' ? 0 : height",
             :x2="c2x(edge.index)", :y2="nodeY",
             :stroke="edge.color", :stroke-width="2",
             :mask="maskUrl(nodeMaskId)")
        path(v-else,
             :key="nodeEdgeKey(edge)",
             :d="nodeEdgePath(edge)",
             :stroke="edge.color", :stroke-width="2", fill="none",
             :mask="nodeEdgeMask(edge, i)")

    circle(:cx="nodeX", :cy="nodeY", :r="radius", :fill="graph.node.color")

